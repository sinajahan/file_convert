#!/usr/bin/env ruby

require 'file_convert'
require 'yaml'

puts 'Usage: file_convert config.yml file.doc'

@configurations ||= YAML.load_file(ARGV[0])

FileConvert::Converter.configure do |config|
  config.drive_key_path = @configurations['DRIVE_KEY_PATH']
  config.drive_service_account = @configurations['DRIVE_SERVICE_ACCOUNT']
  config.s3_key = @configurations['S3_KEY']
  config.s3_secret = @configurations['S3_SECRET']
  config.s3_bucket = @configurations['S3_BUCKET']
  config.tmp_folder = @configurations['TMP_FOLDER']
end

converter = FileConvert::Converter.new
puts converter.to_txt_from_s3 ARGV[1]